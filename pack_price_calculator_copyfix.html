<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pack Prices Calculator</title>
<style>
  :root{--bg:#0f0f10;--card:#16171a;--ink:#ffffff;--muted:#b7bcc7;--border:#2b2d31;--focus:#5b9dff}
  *{box-sizing:border-box}html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,"Apple Color Emoji","Segoe UI Emoji";line-height:1.45}
  header{padding:24px 18px 8px;text-align:center}
  h1{margin:0;font-size:clamp(1.25rem,1rem + 2vw,2rem)}
  .wrap{max-width:900px;margin:0 auto;padding:8px 18px 36px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;margin-top:14px;box-shadow:0 1px 0 rgba(255,255,255,.03) inset, 0 10px 30px rgba(0,0,0,.25)}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media (min-width:760px){.grid{grid-template-columns:repeat(3,1fr)}.grid .wide{grid-column:span 3}}
  label{font-size:.9rem;color:var(--muted);display:block;margin-bottom:6px}
  select,input[type="number"]{width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:#0b0c0f;color:var(--ink);font-size:1rem}
  select:focus,input:focus{border-color:var(--focus);box-shadow:0 0 0 3px rgba(91,157,255,.25);outline:0}
  .muted{color:var(--muted);font-size:.9rem}
  .totals{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .totals .box{background:#0b0c0f;border:1px solid var(--border);border-radius:12px;padding:12px;text-align:center}
  .totals .value{font-size:1.25rem;font-weight:700;margin-top:4px}
  .btn{display:inline-block;padding:12px 16px;border-radius:12px;border:1px solid var(--border);background:linear-gradient(180deg,#2a2b31,#1a1b22);color:var(--ink);text-decoration:none;cursor:pointer}
  .btn:active{transform:scale(.98)}
  .btn.secondary{background:linear-gradient(180deg,#1e2026,#12141a)}
  .note{font-size:.9rem;color:var(--muted)}
  .pill{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:#0b0c0f;color:var(--muted);font-size:.8rem;margin-left:6px}
  .flex-between{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .btn-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:12px}
  .hidden{display:none !important}
  footer{color:var(--muted);text-align:center;padding:24px 0 40px}
  .fallback{margin-top:10px}
  .fallback textarea{width:100%;background:#0b0c0f;color:var(--ink);border:1px dashed var(--border);border-radius:10px;padding:10px;min-height:110px}
  .ok{color:#9be28a} .warn{color:#ffd25b} .err{color:#ff8a8a}
</style>
</head>
<body>
<header>
  <h1>Pack Prices – Instant Calculator</h1>
  <div class="muted">Pick size, option, finish, and quantity to get the exact unit price and total.</div>
</header>

<div class="wrap">
  <div class="card" id="app" hidden>
    <div class="grid">
      <div>
        <label for="size">Pack Size</label>
        <select id="size" aria-label="Pack Size">
          <option value="3.5g">3.5g (10 × 12.5cm) & Vape (6 × 16cm)</option>
          <option value="28g">28g (13 × 21cm)</option>
          <option value="125g">125g (18 × 29cm)</option>
          <option value="250g">250g / 1/2 LB (23 × 34cm)</option>
          <option value="500g">500g / 1 LB (30 × 40cm)</option>
        </select>
      </div>
      <div>
        <label for="option">Product Option</label>
        <select id="option" aria-label="Product Option">
          <option value="stickersOnly">Stickers Only</option>
          <option value="stickersBags">Stickers + Bags (separate)</option>
          <option value="prelabelled">Pre‑Labelled Bags (stuck on)</option>
          <option value="bagsOnly">Bags Only (packs)</option>
        </select>
      </div>
      <div id="finishWrap">
        <label for="finish">Finish</label>
        <select id="finish" aria-label="Finish">
          <option value="gloss">Gloss / Matt</option>
          <option value="holo">Holographic / Glitter</option>
        </select>
      </div>
      <div id="qtyWrap" class="wide">
        <label for="qty">Quantity</label>
        <input type="number" id="qty" min="50" step="1" value="50" aria-label="Quantity" />
        <div class="note" id="tierHint"></div>
      </div>
      <div id="packWrap" class="wide hidden">
        <label for="packCount">Select Pack Size (Bags Only)</label>
        <select id="packCount" aria-label="Pack size for Bags Only">
          <option value="50">Pack of 50</option>
          <option value="100">Pack of 100</option>
          <option value="250">Pack of 250</option>
          <option value="500">Pack of 500</option>
          <option value="1000">Pack of 1000</option>
        </select>
      </div>
    </div>

    <div class="card">
      <label><input type="checkbox" id="addAI" /> Add Pack Design – Incorporating AI (+£50 one‑off)</label><br/>
      <label><input type="checkbox" id="addIllustration" /> Add Hand‑Drawn Illustration (+£100 one‑off)</label>
    </div>

    <div class="grid" style="margin-top:14px">
      <div class="totals wide">
        <div class="box">
          <div class="muted">Unit Price</div>
          <div class="value" id="unitPrice">£0.00</div>
          <div class="note" id="unitNote"></div>
        </div>
        <div class="box">
          <div class="muted">Total (incl. add‑ons)</div>
          <div class="value" id="totalPrice">£0.00</div>
          <div class="note" id="totalNote"></div>
        </div>
      </div>
    </div>

    <div class="flex-between" style="margin-top:10px">
      <div class="muted">Tier Guidance</div>
      <span class="pill" id="tierLabel">—</span>
    </div>
    <div class="note" style="margin-top:6px" id="tierRules">
      Minimums vary by size. Enter your quantity to see the best tier and price.
    </div>

    <div class="btn-row">
      <button class="btn" id="copyQuote" type="button">Copy Quote Info</button>
      <button class="btn secondary" id="shareBtn" type="button">Share…</button>
      <button class="btn secondary" id="emailBtn" type="button">Email this quote</button>
      <span class="muted" id="copyMsg"></span>
    </div>
    <div class="note" style="margin-top:6px">Use this to copy and paste all the above information to us for your order via Instagram or email.</div>

    <div class="fallback hidden" id="fallbackBox">
      <div class="note warn" style="margin-bottom:6px">Copy button not supported in this browser. You can manually select & copy the quote below:</div>
      <textarea id="fallbackText" readonly></textarea>
      <div class="note" style="margin-top:6px">Tip: Tap inside, then <strong>Select All</strong> → <strong>Copy</strong>. On iPhone/iPad, tap-hold to bring up the copy menu.</div>
    </div>
  </div>

  <div class="card" id="loadingMsg">Loading calculator…</div>
</div>

<footer>© Pack Prices</footer>

<script>
(function(){
  const onReady = (fn) => (document.readyState === 'loading') ? document.addEventListener('DOMContentLoaded', fn) : fn();

  onReady(function(){
    const priceData = {
      tiers: [
        { min:50, max:99, label:"50–99" },
        { min:100, max:249, label:"100–249" },
        { min:250, max:499, label:"250–499" },
        { min:500, max:999, label:"500–999" },
        { min:1000, max:Infinity, label:"1000+" }
      ],
      "3.5g": {
        stickerOnly: { gloss:[0.50,0.43,0.40,0.32,0.30], holo:[0.75,0.64,0.60,0.48,0.45] },
        stickersBags: { gloss:[0.65,0.58,0.55,0.42,0.40], holo:[0.87,0.76,0.72,0.58,0.55] },
        prelabelled: { gloss:[1.20,0.80,0.70,0.65,0.62], holo:[1.45,1.00,0.90,0.81,0.77] },
        bagsOnlyPacks: { 50:8, 100:15, 250:35, 500:65, 1000:120 }
      },
      "28g": {
        stickerOnly: { gloss:[1.07,0.95,0.88,0.75,0.68], holo:[1.65,1.42,1.32,1.12,1.02] },
        stickersBags: { gloss:[1.29,1.17,1.10,0.90,0.83], holo:[1.87,1.64,1.54,1.27,1.17] },
        prelabelled: { gloss:[1.69,1.58,1.50,1.30,1.23], holo:[2.27,2.05,1.94,1.67,1.57] },
        bagsOnlyPacks: { 50:12, 100:22, 250:55, 500:95, 1000:175 }
      },
      "125g": {
        stickerOnly: { gloss:[2.00,1.85,1.70,1.45,1.25], holo:[3.00,2.77,2.55,2.17,1.87] },
        stickersBags: { gloss:[2.45,2.30,2.15,1.75,1.55], holo:[3.45,3.22,2.90,2.47,2.17] },
        prelabelled: { gloss:[3.10,2.95,2.80,2.40,2.20], holo:[4.10,3.87,3.55,3.12,2.82] },
        bagsOnlyPacks: { 50:28, 100:50, 250:115, 500:170, 1000:300 }
      },
      "250g": {
        stickerOnly: { gloss:[2.95,2.73,2.40,2.14,1.85], holo:[4.50,4.09,3.60,3.21,2.77] },
        stickersBags: { gloss:[3.40,3.18,2.85,2.44,2.15], holo:[4.95,4.54,4.05,3.51,3.07] },
        prelabelled: { gloss:[4.05,3.83,3.50,3.09,2.80], holo:[5.60,5.19,4.70,4.16,3.72] },
        bagsOnlyPacks: { 50:28, 100:50, 250:115, 500:170, 1000:300 }
      },
      "500g": {
        tiers: [
          { min:1, max:1, label:"1" },
          { min:2, max:2, label:"2" },
          { min:5, max:5, label:"5" },
          { min:10, max:10, label:"10" },
          { min:20, max:Infinity, label:"20+" }
        ],
        stickerOnly: { gloss:[6,4.5,4,3.5,3], holo:[9,6.75,6,5.25,4.5] },
        stickersBags: { gloss:[7,5.5,5,4.5,4], holo:[10,7.75,7,6.25,5.5] },
        prelabelled: { gloss:[10,7.5,7,6.5,6], holo:[13,10.75,9,8.25,7.5] },
        bagsOnlyPerUnit: [2, 1.75, 1.5, 1.2, 1.0]
      }
    };

    // DOM
    const $ = (id)=>document.getElementById(id);
    const sizeEl = $('size'), optionEl = $('option'), finishEl = $('finish'), qtyEl = $('qty');
    const packWrap = $('packWrap'), packCountEl = $('packCount'), finishWrap = $('finishWrap'), qtyWrap = $('qtyWrap');
    const unitPriceEl = $('unitPrice'), unitNoteEl = $('unitNote'), totalPriceEl = $('totalPrice'), totalNoteEl = $('totalNote');
    const tierLabelEl = $('tierLabel'), tierHintEl = $('tierHint'), tierRulesEl = $('tierRules');
    const addAI = $('addAI'), addIllustration = $('addIllustration');
    const copyBtn = $('copyQuote'), shareBtn = $('shareBtn'), emailBtn = $('emailBtn'), copyMsg = $('copyMsg');
    const fallbackBox = $('fallbackBox'), fallbackText = $('fallbackText');
    const app = $('app'), loadingMsg = $('loadingMsg'); app.hidden=false; loadingMsg.hidden=true;

    const formatGBP = n => new Intl.NumberFormat('en-GB',{style:'currency',currency:'GBP'}).format(n);
    const getTiers = size => (size==='500g') ? priceData['500g'].tiers : priceData.tiers;
    const getTierIndex = (size,q)=>{ const t=getTiers(size); for(let i=0;i<t.length;i++){ if(q>=t[i].min&&q<=t[i].max) return i; } return -1; };

    function updateUI(){
      const size=sizeEl.value, opt=optionEl.value;
      const usePacks = (opt==='bagsOnly' && size!=='500g');
      finishWrap.classList.toggle('hidden', opt==='bagsOnly');
      packWrap.classList.toggle('hidden', !usePacks);
      qtyWrap.classList.toggle('hidden', usePacks);
      if(usePacks){
        tierRulesEl.textContent = "Bags Only is sold in fixed packs: 50, 100, 250, 500, or 1000.";
        tierLabelEl.textContent = "Pack selection required"; tierHintEl.textContent = "";
      }else{
        tierRulesEl.textContent = (size==='500g') ? "500g tiers: 1, 2, 5, 10, 20+." : "Minimum order 50; tiers: 50–99, 100–249, 250–499, 500–999, 1000+.";
        const q=parseInt(qtyEl.value||'0',10), idx=getTierIndex(size,q);
        if(idx===-1){ tierHintEl.textContent = (size==='500g') ? "Enter 1, 2, 5, 10, or 20+." : "Enter at least 50."; tierLabelEl.textContent="—"; }
        else { tierHintEl.textContent = "Current tier: " + getTiers(size)[idx].label; tierLabelEl.textContent = getTiers(size)[idx].label; }
      }
    }

    function calculate(){
      const size=sizeEl.value, opt=optionEl.value, finish=finishEl.value;
      updateUI();
      let subtotal=0, unit=0;
      if(opt==='bagsOnly' && size!=='500g'){
        const pk=parseInt(packCountEl.value,10);
        const price=(priceData[size].bagsOnlyPacks||{})[pk]||0;
        unitPriceEl.textContent="—"; unitNoteEl.textContent=`Bags Only – pack of ${pk}`;
        subtotal=price;
      }else{
        const q=Math.max(1, parseInt(qtyEl.value||'0',10));
        const idx=getTierIndex(size,q); if(idx===-1){ unitPriceEl.textContent="£0.00"; totalPriceEl.textContent="£0.00"; totalNoteEl.textContent=""; return; }
        if(size==='500g' && opt==='bagsOnly'){ unit=priceData['500g'].bagsOnlyPerUnit[idx]; unitNoteEl.textContent="Bags Only"; }
        else {
          const mapKey=(opt==='stickersOnly')?'stickerOnly':(opt==='stickersBags'?'stickersBags':'prelabelled');
          unit = priceData[size][mapKey][finish][idx];
          unitNoteEl.textContent=(finish==='gloss')?'Gloss / Matt':'Holographic / Glitter';
        }
        subtotal=unit*q; unitPriceEl.textContent=formatGBP(unit);
      }
      const addons=(addAI.checked?50:0)+(addIllustration.checked?100:0);
      totalPriceEl.textContent=formatGBP(subtotal+addons);
      totalNoteEl.textContent = addons ? `Includes add‑ons: ${formatGBP(addons)} one‑off` : "No add‑ons selected";
    }

    function buildSummary(){
      const sizeText=sizeEl.options[sizeEl.selectedIndex].text;
      const optText=optionEl.options[optionEl.selectedIndex].text;
      const finishText = finishWrap.classList.contains('hidden') ? '' : ' • ' + finishEl.options[finishEl.selectedIndex].text;
      const qtyText = packWrap.classList.contains('hidden') ? `Quantity: ${qtyEl.value}` : packCountEl.options[packCountEl.selectedIndex].text;
      const unitText = (unitPriceEl.textContent==='—') ? '' : `Unit: ${unitPriceEl.textContent}`;
      const totalText = `Total: ${totalPriceEl.textContent}`;
      const addons=[]; if(addAI.checked) addons.push("AI Design (+£50)"); if(addIllustration.checked) addons.push("Illustration (+£100)");
      const addonsText = addons.length ? `Add‑ons: ${addons.join(", ")}` : "Add‑ons: none";
      const tier = tierLabelEl.textContent; const tierText = (tier && tier!=='—') ? `Tier: ${tier}` : "";
      return [
        "Pack Prices – Quote",
        sizeText,
        `${optText}${finishText}`,
        qtyText,
        tierText,
        unitText,
        totalText,
        addonsText
      ].filter(Boolean).join("\n");
    }

    async function copyToClipboard(text){
      try{
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(text);
          return true;
        }
      }catch(e){ }
      try{
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly','');
        ta.style.position='fixed'; ta.style.top='0'; ta.style.left='-9999px';
        document.body.appendChild(ta);
        if (/ipad|iphone|ipod/i.test(navigator.userAgent)) {
          const range = document.createRange(); range.selectNodeContents(ta);
          const sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
          ta.setSelectionRange(0, 999999);
        } else { ta.select(); }
        const ok = document.execCommand('copy');
        document.body.removeChild(ta);
        if (ok) return true;
      }catch(e){ }
      return false;
    }

    function showFallbackArea(text){
      fallbackText.value = text;
      fallbackBox.classList.remove('hidden');
      setTimeout(()=>{ fallbackText.focus(); fallbackText.select(); }, 50);
    }

    async function copyQuote(){
      const text = buildSummary();
      const ok = await copyToClipboard(text);
      if (ok){
        copyMsg.textContent = "Quote copied! Paste into Instagram DM or email.";
        copyMsg.className = "muted ok";
      } else {
        copyMsg.textContent = "Copy not supported here. Use the text box below to select & copy.";
        copyMsg.className = "muted warn";
        showFallbackArea(text);
      }
      setTimeout(()=>{ copyMsg.textContent=""; copyMsg.className="muted"; }, 3500);
    }

    function shareQuote(){
      const text=buildSummary();
      if(navigator.share){ navigator.share({ title:"Pack Prices Quote", text }).catch(()=>{}); }
      else { copyQuote(); }
    }

    function emailQuote(){
      const text=buildSummary();
      const subject = encodeURIComponent("Pack Prices Quote");
      const body = encodeURIComponent(text + "\n\n(Reply with your name & delivery details)");
      window.location.href = `mailto:?subject=${subject}&body=${body}`;
    }

    [sizeEl, optionEl, finishEl, qtyEl, packCountEl, addAI, addIllustration].forEach(el=>{
      el.addEventListener('input', calculate);
      el.addEventListener('change', calculate);
    });
    optionEl.addEventListener('change', ()=>{
      const isBags = optionEl.value==='bagsOnly';
      if(isBags){ if(sizeEl.value==='500g'){ qtyEl.min=1; qtyEl.value=1; } else { packCountEl.value='50'; } }
      else { qtyEl.value=(sizeEl.value==='500g')?1:50; }
      calculate();
    });
    sizeEl.addEventListener('change', ()=>{
      if(sizeEl.value==='500g'){ qtyEl.min=1; if(optionEl.value!=='bagsOnly' && qtyEl.value<1) qtyEl.value=1; }
      else { qtyEl.min=50; if(optionEl.value!=='bagsOnly' && qtyEl.value<50) qtyEl.value=50; }
      calculate();
    });

    copyBtn.addEventListener('click', copyQuote);
    shareBtn.addEventListener('click', shareQuote);
    emailBtn.addEventListener('click', emailQuote);

    calculate();
  });
})();
</script>
</body>
</html>
